---
title: O que o driver manager faz | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 07ab0784e6f6ad4487a02a179a5fa3be2617c930
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306557"
---
# <a name="what-the-driver-manager-does"></a>O que o Gerenciador de Driver faz
A tabela a seguir resume como o ODBC *3.x* Driver Manager mapeia chamadas para drivers ODBC *2.x* e ODBC *3.x.*  
  
|Função ou<br /><br /> atributo de instrução|Comentários|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Aponta para o marcador a ser usado com **SQLFetchScroll**. A seguir, os detalhes da implementação:<br /><br /> - Quando um aplicativo define isso em um driver ODBC *2.x,* o Gerenciador de Driver ODBC *3.x* armazena o cache. Ele defaz referência ao ponteiro e passa o valor para o driver ODBC *2.x* no argumento *FetchOffset* do **SQLExtendedFetch** quando **o SQLFetchScroll** é chamado posteriormente pelo aplicativo.<br />- Quando um aplicativo define isso em um driver ODBC *3.x,* o Gerenciador de Driver ODBC *3.x* passa a chamada para o motorista.|  
|SQL_ATTR_ROW_STATUS_PTR|Aponta para o array de status de linha preenchido por **SQLFetch,** **SQLFetchScroll,** **SQLBulkOperations**e **SQLSetPos**. A seguir, os detalhes da implementação:<br /><br /> - Quando um aplicativo define isso em um driver ODBC *2.x,* o Gerenciador de Driver ODBC *3.x* armazena seu valor. Ele passa esse valor para o driver ODBC *2.x* no argumento *RowStatusArray* do **SQLExtendedFetch** quando **SQLFetchScroll** ou **SQLFetch** é chamado.<br />- Quando um aplicativo define isso em um driver ODBC *3.x,* o Gerenciador de Driver ODBC *3.x* passa a chamada para o motorista.<br />- No estado S6, se um aplicativo definir SQL_ATTR_ROW_STATUS_PTR e, em seguida, chamar **SQLBulkOperations** (com uma *operação* de SQL_ADD) ou **SQLSetPos** sem antes chamar **SQLFetchOu** ou **SQLFetchScroll**, SQLSTATE HY011 (Atributo não pode ser definido agora) é devolvido.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Aponta para o buffer no qual **SQLFetch** e **SQLFetchScroll** retornam o número de linhas buscadas. A seguir, os detalhes da implementação:<br /><br /> - Quando um aplicativo define isso em um driver ODBC *2.x,* o Gerenciador de Driver ODBC *3.x* armazena seu valor. Ele passa esse valor para o driver ODBC *2.x* no argumento *RowCountPtr* do **SQLExtendedFetch** quando **SQLFetch** ou **SQLFetchScroll** é chamado pelo aplicativo.<br />- Quando um aplicativo define isso em um driver ODBC *3.x,* o Gerenciador de Driver ODBC *3.x* passa a chamada para o motorista.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Define o tamanho do conjunto de linhas. A seguir, os detalhes da implementação:<br /><br /> - Quando um aplicativo define isso em um driver ODBC *2.x,* o Gerenciador de Driver ODBC *3.x* mapeia-o para o atributo de declaração SQL_ROWSET_SIZE.<br />- Quando um aplicativo define isso em um driver ODBC *3.x,* o Gerenciador de Driver ODBC *3.x* passa a chamada para o motorista.<br />- Quando um aplicativo que trabalha com um driver ODBC *3.x* chama **SQLSetScrollOptions,** SQL_ROWSET_SIZE é definido como o valor no argumento *RowsetSize* se o driver subjacente não suportar **SQLSetScrollOptions**.|  
|SQL_ROWSET_SIZE|Define o tamanho do conjunto de linhas usado pelo **SQLExtendedFetch** quando **o SQLExtendedFetch** é chamado por um aplicativo ODBC *2.x.* A seguir, os detalhes da implementação:<br /><br /> - Quando um aplicativo define isso, o ODBC *3.x* Driver Manager passa a chamada para o motorista, independentemente da versão do driver.<br />- Quando um aplicativo que trabalha com um driver ODBC *2.x* chama **SQLSetScrollOptions,** SQL_ROWSET_SIZE é definida como valor no argumento **RowsetSize.**|  
|**SQLBulkOperations**|Executa uma operação de inserção, ou atualiza, exclui ou busca por operações de marcador. A seguir, os detalhes da implementação:<br /><br /> - Quando um aplicativo chama **SQLBulkOperations** com uma *operação* de SQL_ADD em um driver ODBC *2.x,* o Gerenciador de Driver ODBC *3.x* mapeia-o para **SQLSetPos** com uma *Operação* de SQL_ADD.<br />- Ao trabalhar com um driver ODBC *2.x* que não suporta **SQLSetPos** com uma *Operação* de SQL_ADD, o Gerenciador de Driver ODBC *3.x* não mapeia **SQLSetPos** com uma *Operação* de SQL_ADD à **SQLBulkOperations** com uma *Operação* de SQL_ADD. Isso porque **o SQLBulkOperations** não pode ser chamado no estado S7, que no ODBC *2.x* foi o único estado no qual **sqlsetpos** poderia ser chamado.<br />- Se o aplicativo chamar **SQLBulkOperations** com uma *operação* de SQL_ADD em um driver ODBC *2.x* antes de chamar **SQLFetchScroll,** o ODBC *3.x* Driver Manager retorna um erro.|  
|**Sqlextendedfetch**|Retorna o conjunto de linhas especificado. Com exceção da restrição anotada, o ODBC *3.x* Driver Manager passa chamadas para **SQLExtendedFetch** para o motorista, independentemente da versão do driver.|  
|**SQLFetch**|Retorna o próximo conjunto de linhas. A seguir, os detalhes da implementação:<br /><br /> - Quando um aplicativo chama **o SQLFetch** em um driver ODBC *2.x,* o Gerenciador de Driver ODBC *3.x* mapeia-o para **SQLExtendedFetch**. O *argumento FetchOrientation* do **SQLExtendedFetch** está definido como SQL_FETCH_NEXT. O Gerenciador de driver usa o valor armazenado em cache do atributo de declaração SQL_ATTR_ROW_STATUS_PTR para o argumento *RowStatusArray* e o valor armazenado em cache do atributo de declaração SQL_ATTR_ROWS_FETCHED_PTR para o argumento *RowCountPtr.*<br />- Um aplicativo ODBC *3.x* pode misturar chamadas para **SQLFetch** e **SQLFetchScroll** em um driver ODBC *2.x* porque o ODBC *3.x* Driver Manager mapeia **SQLFetch** para **SQLExtendedFetch** quando um aplicativo o chama em um driver ODBC *2.x.*<br />- Se um driver ODBC *2.x* não suportar **sQLExtendedFetch,** o Gerenciador de Driver ODBC *3.x* não mapeia **SQLFetch** ou **SQLFetchScroll** para **SQLExtendedFetch** quando um aplicativo o chama nesse driver. Se o aplicativo tentar definir SQL_ATTR_ROW_ARRAY_SIZE para um valor superior a 1, o SQLSTATE HYC00 (recurso opcional não implementado) será devolvido.<br />- Com exceção das restrições anotadas, o ODBC *3.x* Driver Manager passa chamadas para **SQLFetch** para o motorista, independentemente da versão do driver.|  
|**SQLFetchScroll**|Retorna o conjunto de linhas especificado. A seguir, os detalhes da implementação:<br /><br /> - Quando um aplicativo chama **SQLFetchScroll** em um driver ODBC *2.x,* o Gerenciador de Driver ODBC *3.x* mapeia-o para **SQLExtendedFetch**. Ele usa o valor armazenado em cache do atributo de declaração SQL_ATTR_ROW_STATUS_PTR para o argumento *RowStatusArray* e o valor armazenado em cache do atributo de declaração SQL_ATTR_ROWS_FETCHED_PTR para o argumento *RowCountPtr.* Se o argumento *FetchOrientation* no **SQLFetchScroll** for SQL_FETCH_BOOKMARK, ele usará o valor armazenado em cache do atributo de declaração SQL_ATTR_FETCH_BOOKMARK_PTR para o argumento *FetchOffset* e reame da dono um erro se o argumento *FetchOffset* do **SQLFetchScroll** não for 0.<br />- Quando um aplicativo chama isso em um driver ODBC *3.x,* o Gerenciador de Driver ODBC *3.x* passa a chamada para o motorista.|  
|**SQLSetPos**|Realiza várias operações posicionadas. O ODBC *3.x* Driver Manager passa chamadas para **SQLSetPos** para o driver, independentemente da versão do driver.|  
|**Opções de SQLSetScroll**|Quando o Gerenciador de driver mapeia **SQLSetScrollOptions** para um aplicativo que trabalha com um driver ODBC *3.x* que não suporta **SQLSetScrollOptions,** o Gerenciador de driver define a opção de declaração SQL_ROWSET_SIZE, não o atributo de declaração SQL_ATTR_ROW_ARRAY_SIZE, para o argumento *RowsetSize* no **SQLSetScrollOption**. Como resultado, **sqlsetscrolloptions** não pode ser usado por um aplicativo ao buscar várias linhas por uma chamada para **SQLFetch** ou **SQLFetchScroll**. Ele só pode ser usado quando busca várias linhas por uma chamada para **SQLExtendedFetch**.|
