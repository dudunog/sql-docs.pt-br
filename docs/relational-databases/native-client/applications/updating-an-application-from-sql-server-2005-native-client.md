---
title: Atualização do SQL 2005
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, updating applications
ms.assetid: 1e1e570c-7f14-4e16-beab-c328e3fbdaa8
author: markingmyname
ms.author: maghan
monikerRange: '>=aps-pdw-2016||=azuresqldb-current||=azure-sqldw-latest||>=sql-server-2016||=sqlallproducts-allversions||>=sql-server-linux-2017||=azuresqldb-mi-current'
ms.openlocfilehash: 3287f5faf6d748a433a425c1ecf505bbe551d3b2
ms.sourcegitcommit: a3f5c3742d85d21f6bde7c6ae133060dcf1ddd44
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/15/2020
ms.locfileid: "81388293"
---
# <a name="updating-an-application-from-sql-server-2005-native-client"></a>Atualizando um aplicativo no SQL Server 2005 Native Client
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

  Este tópico aborda as últimas alterações no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client desde o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client no [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].  
  
 Ao atualizar do MDAC (Microsoft Data Access Components) para o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, você também poderá observar algumas diferenças de comportamento. Para obter mais informações, consulte [Atualizar um aplicativo para cliente nativo do servidor SQL do MDAC](../../../relational-databases/native-client/applications/updating-an-application-to-sql-server-native-client-from-mdac.md).  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 fornecido com o [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]. [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 fornecido com o [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.5 fornecido com o [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)]. [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 11.0 fornecido com o [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] e o [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].  
  
|Comportamento alterado no SQL Server Native Client desde o [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]|Descrição|  
|------------------------------------------------------------------------------------|-----------------|  
|O OLE DB preenche apenas até a escala definida.|Para conversões em que os dados [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] convertidos são [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]enviados para o servidor, o Cliente Nativo (começando em ) bloqueia zeros em dados apenas até o comprimento máximo dos valores de **data-hora.** O SQL Server Native Client 9.0 e preenchia até nove dígitos.|  
|Validar DBTYPE_DBTIMESTAMP para ICommandWithParameter::SetParameterInfo.|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]O Cliente Nativo [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)](a partir de ) implementa o requisito OLE DB para *bScale* em ICommandWithParameter::SetParameterInfo a ser definido como precisão dos segundos fracionados para DBTYPE_DBTIMESTAMP.|  
|Agora, o procedimento armazenado **sp_columns** retorna **"NO"** em vez de **"NO "** para a coluna IS_NULLABLE.|A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] partir do Cliente Nativo[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]10.0 (), **sp_columns** procedimento armazenado agora retorna **"NÃO"** em vez de **"NÃO"** para uma coluna de IS_NULLABLE.|  
|SQLSetDescRec, SQLBindParameter e SQLBindCol agora realizam verificação de consistência.|Antes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] do Cliente Nativo 10.0, a configuração SQL_DESC_DATA_PTR não causou uma verificação de consistência para qualquer tipo de descritor no SQLSetDescRec, SQLBindParameter ou SQLBindCol.|  
|SQLCopyDesc agora faz verificação de consistência do descritor.|Antes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] do Cliente Nativo 10.0, o SQLCopyDesc não fez uma verificação de consistência quando o campo SQL_DESC_DATA_PTR foi definido em um registro específico.|  
|SQLGetDescRec não faz mais uma verificação de consistência do descritor.|Antes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] do Cliente Nativo 10.0, o SQLGetDescRec realizou uma verificação de consistência do descritor quando o campo SQL_DESC_DATA_PTR foi definido. Isso não era exigido pela especificação ODBC e, no [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) e em versões posteriores, essa verificação de consistência não é mais executada.|  
|Erro diferente retornado quando a data está fora do intervalo.|Para o tipo **de data-hora,** um [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] número de erro [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]diferente será retornado pelo Cliente Nativo (começando em ) para uma data fora de alcance do que foi devolvido em versões anteriores.<br /><br /> Especificamente, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o Cliente Nativo 9.0 retornou 22007 para todos os valores [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de ano fora do intervalo[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]em conversões de string **sem data**, e o Cliente Nativo começando com a versão 10.0 ( ) retorna 22008 quando a data estiver dentro do intervalo suportado por **data2,** mas fora do intervalo suportado por **data** ou **data pequena.**|  
|O valor **datetime** trunca segundos fracionários e não será arredondado se o arredondamento alterar o dia.|Antes do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, o comportamento do cliente para valores **datetime** enviados ao servidor era arredondá-los para o 1/300º de segundo mais próximo. A partir do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, esse cenário provocará um truncamento de segundos fracionários, se o arredondamento alterar o dia.|  
|Possível truncamento de segundos para o valor **datetime**.|Um aplicativo compilado com o [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (ou posterior) que se conecta a um servidor [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 truncará segundos e segundos fracionários na parte de hora dos dados enviados ao servidor, se for feita uma associação com uma coluna datetime com um identificador de tipo DBTYPE_DBTIMESTAMP (OLE DB) ou SQL_TIMESTAMP (ODBC) e uma escala de 0.<br /><br /> Por exemplo:<br /><br /> Dados de entrada: 1994-08-21 21:21:36.000<br /><br /> Dados inseridos: 1994-08-21 21:21:00.000|  
|A conversão de dados OLE DB de DBTYPE_DBTIME em DBTYPE_DATE não faz mais com que o dia seja alterado.|Antes do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, se a parte de hora de DBTYPE_DATE estivesse dentro de meio segundo de meia-noite, o código de conversão OLE DB fazia com que o dia fosse alterado. A partir do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, o dia não será alterado (segundos fracionários são truncados e não são arredondados).|  
|Alterações de conversão de IBCPSession::BCColFmt.|Começando [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] no Cliente Nativo 10.0, quando você usa o IBCPSession::BCOColFmt para converter SQLDATETIME ou SQLDATETIME para um tipo de string, um valor fracionado é exportado. Por exemplo, na conversão do tipo SQLDATETIME no tipo SQLNVARCHARMAX, versões anteriores do [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client retornavam<br /><br /> 1989-02-01 00:00:00. [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 e versões posteriores retornam 1989-02-01 00:00:00.0000000.|  
|O tamanho dos dados enviados deve corresponder ao comprimento especificado em SQL_LEN_DATA_AT_EXEC.|Quando SQL_LEN_DATA_AT_EXEC for usado, o tamanho dos dados deverá corresponder ao comprimento especificado com SQL_LEN_DATA_AT_EXEC. Você pode usar SQL_DATA_AT_EXEC, mas existem benefícios de desempenho potenciais em usar SQL_LEN_DATA_AT_EXEC.|  
|Os aplicativos personalizados que usam a API BCP agora podem ver um aviso.|A API BCP gerará uma mensagem de aviso se o comprimento dos dados for maior do que o comprimento especificado para um campo para todos os tipos. Anteriormente, esse aviso era fornecido apenas para tipos de caracteres, mas não será emitido para todos os tipos.|  
|A inserção de uma cadeia de caracteres vazia em uma associação **sql_variant** como um tipo de data/hora gera um erro.|No [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0, a inserção de uma cadeia de caracteres vazia em uma associação **sql_variant** como um tipo de data/hora não gerava um erro. O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 (e posterior) gera corretamente um erro nessa situação.|  
|Validação mais rígida dos parâmetros SQL_C_TYPE _TIMESTAMP e DBTYPE_DBTIMESTAMP.|Antes [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] do Cliente Nativo, os valores **de data-hora** eram arredondados [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]para se adequar à escala de **colunas** de data e **data** por . O [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (bem como as versões posteriores) aplica as regras de validação mais rígidas que são definidas na especificação ODBC principal para segundos fracionários. Se não for possível converter um valor de parâmetro no tipo SQL usando a escala especificada ou implícita pela associação de cliente sem truncamento de dígitos à direita, será retornado um erro.|  
|O [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pode retornar resultados diferentes quando um gatilho é executado.|As alterações introduzidas no [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] podem fazer com que um aplicativo retorne resultados diferentes de uma instrução que causou a execução de um gatilho quando **NOCOUNT OFF** estava em vigor. Nessa situação, o aplicativo pode gerar um erro. Para resolver esse erro, defina **NOCOUNT ON** no gatilho ou ligue para SQLMoreResults para avançar para o próximo resultado.|  
  
## <a name="see-also"></a>Consulte Também  
 [Programação do SQL Server Native Client](../../../relational-databases/native-client/sql-server-native-client-programming.md)  
  
  
