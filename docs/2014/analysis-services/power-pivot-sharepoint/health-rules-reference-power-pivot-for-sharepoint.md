---
title: Referência de regras de integridade (PowerPivot para SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 47ae04ce-7b9d-49c2-8dbc-bafcb73d4603
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4698c24ace37a8dd804c9fc1eff9002d9487d352
ms.sourcegitcommit: f0772f614482e0b3cde3609e178689ce62ca3a19
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/09/2020
ms.locfileid: "84540329"
---
# <a name="health-rules-reference-powerpivot-for-sharepoint"></a>Referência de regras de integridade (PowerPivot para SharePoint)
  Este tópico de referência descreve as regras de integridade do SharePoint que são adicionadas por uma instalação do PowerPivot para SharePoint. Estas regras são usadas para relatar problemas com integridade de servidor, disponibilidade ou configuração de um aplicativo de serviço [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] ou sua instância associada do [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
 A tabela a seguir lista as regras na ordem em que elas aparecem na página Definições de Regra do Analisador de Integridade na Administração Central do SharePoint. Regras configuráveis são as regras para as quais você pode alterar os limites de ativação. Para obter mais informações, consulte [regras de integridade do PowerPivot – configurar](configure-power-pivot-health-rules.md). O Reparo Automático indica que há uma solução interna que você pode clicar de dentro da página de relatórios de problemas para resolver o problema.  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013 &#124; SharePoint 2010|  
  
 **Observação:** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instala diferentes conjuntos de regras de integridade para diferentes versões do SharePoint. Consulte a coluna "versão" na tabela abaixo, ou você pode executar o seguinte comando do Windows PowerShell para ver as regras instaladas.  
  
```powershell
Get-SPHealthAnalysisRule | Select name, enabled, summary | Where {$_.summary -like "*power*"}  | Format-Table -Property * -AutoSize | Out-Default  
```  
  
|Regra|Configurável|Reparo automático|Versão|Descrição|  
|----------|------------------|-----------------|-------------|-----------------|  
|PowerPivot: o provedor OLE DB do Analysis Services não está instalado neste computador.|No|Não|SharePoint 2010|O provedor OLE DB do Analysis Services ou não está instalado no servidor ou é da versão errada. Esta regra aparece quando seu farm do SharePoint inclui instâncias de Serviços do Excel em servidores de aplicativos que não têm o PowerPivot para SharePoint. A regra avisa que o provedor OLE DB do Analysis Services usado pelos Serviços do Excel para se conectar a dados PowerPivot não está instalado. Para resolver esse problema, instale o provedor OLE DB em cada servidor de Serviços do Excel que não tiver o provedor OLE DB do Analysis Services. Você pode baixar e instalar o provedor OLE DB do Analysis Services do Centro de Download da Microsoft. Para obter mais informações, consulte [Instalar o Provedor OLE DB do Analysis Services nos Servidores SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).|  
|PowerPivot: configurações de Registro para Microsoft.AnalysisServices.ChannelTransport.dll não são válidas após a instalação da versão SQL Server 2008 R2 do provedor MSOLAP neste computador.|Não|Sim|SharePoint 2010|Este é um problema de configuração de servidor. É provável que o ChannelTransport.dll não esteja registrado no assembly global. Execute o reparo automático para esta regra para registrar o .dll em cada servidor que tiver uma instalação do PowerPivot para SharePoint. Como alternativa, você pode executar o regasm.exe manualmente para registrar o arquivo. Se o serviço de timer do SharePoint não estiver sendo executado como administrador local, pode ser necessário realizar o registro manual. Se houver falha para atualizar as configurações do Registro, haverá comunicação lenta com o servidor entre Serviços do Excel e Serviço do Sistema PowerPivot, e poderá haver falhas de conexão em determinadas configurações de segurança.|  
|PowerPivot: o aplicativo de serviço PowerPivot não tem permissão para concluir a operação.|No|Não|SharePoint 2010|Esta regra verifica se a identidade de aplicativo de serviço PowerPivot é proprietário do banco de dados de aplicativo de servidor do PowerPivot e se tem permissões administrativas na instância local do SQL Server Analysis Services. Essas permissões são concedidas automaticamente durante a instalação e a implantação, mas se esta etapa não for concluída, esta regra de integridade ocorrerá.|  
|PowerPivot: a identidade de aplicativo de serviço PowerPivot não deve ser membro do grupo local Administradores.|No|Não|SharePoint 2010|Esta é uma prática recomendada que melhora a segurança global de sua implantação. Se você configurou o aplicativo de serviço PowerPivot para ser executado usando uma conta que pertence ao grupo de Administrador local, deve alterar a conta de serviço para um que não pertença a esse grupo. A recomendação é usar uma conta dedicada e com privilégios mínimos para cada serviço. Ao fazer isso, você fornece isolamento de serviço e facilita a auditoria de logons. Para obter mais informações sobre como alterar a conta de serviço, consulte [Configurar contas de serviço PowerPivot](configure-power-pivot-service-accounts.md).|  
|PowerPivot: a instância do Analysis Services é executada no modo Tabular, mas o parâmetro de configuração que especifica esse modo está desativado.|No|Não|SharePoint 2010|Esta regra verifica se a instância do SQL Server Analysis Services em uma instalação do PowerPivot para SharePoint tem a propriedade de servidor `DeploymentMode` definida como 1. Se a propriedade for definida como outro valor, ou se o serviço de timer do SharePoint que executa o verificador de regra não tiver permissão para abrir o arquivo, esta regra falhará. Para obter mais informações sobre a propriedade do modo de implantação, consulte [Determinar o modo de servidor de uma instância do Analysis Services](../instances/determine-the-server-mode-of-an-analysis-services-instance.md).|  
|PowerPivot: o trabalho do timer de atualização de dados PowerPivot está desativado.|No|Não|SharePoint 2013<br /><br /> SharePoint 2010|Verifique as configurações de trabalho de timer para verificar se o trabalho de timer está habilitado. Se você não estiver usando o recurso de atualização de dados PowerPivot, poderá ignorar esta regra. Para obter mais informações, consulte [PowerPivot data Refresh com o SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md).|  
|PowerPivot: as informações de conta de serviço do SQL Server Analysis Services (PowerPivot) gerenciadas pelo SQL Server Configuration Manager são diferentes das informações de conta gerenciadas pela Administração Central.|No|Não|SharePoint 2010|Esta regra verifica se as informações de conta de serviço no SQL Server Configuration Manager são idênticas às informações de conta gerenciadas na Administração Central para a mesma instância do Analysis Services. Se as contas forem diferentes, uma entrada será adicionada ao relatório de Problema e Resolução, de modo que você possa alterar as informações de conta de serviço no SQL Server Configuration Manager de volta para a conta especificada na Administração Central. O SQL Server Configuration Manager não é uma ferramenta suportada para alterar um nome de usuário ou uma senha da conta de serviço em uma instalação do PowerPivot para SharePoint. Usar a Administração Central habilita o uso do recurso de contas gerenciadas no SharePoint. E, o que é mais importante, se seu farm incluir vários servidores PowerPivot para SharePoint, ter configurações de conta de serviço inconsistentes pode interromper o processamento e as operações de consulta no servidor que tiver informações de serviço incorretas.<br /><br /> Em um único servidor, as pastas de trabalho PowerPivot funcionarão temporariamente quando esta regra for disparada, mas é aconselhável que você corrija o problema o mais cedo possível. As permissões de banco de dados e de sistema de arquivos são atualizadas usando as informações de conta especificadas na Administração Central.|  
|PowerPivot: a solução implantada de farm não é atualizada.|Não|Sim|SharePoint 2010|Uma instalação do PowerPivot para SharePoint usa uma solução de nível de farm e uma solução de nível de aplicativo Web para instalar seus recursos. Esta regra indica que a solução do farm não é a atual em relação à versão ou ao servidor ou possivelmente a solução de Web. É provável que este seja um problema de implantação do servidor. Para solucionar este problema, execute a Instalação do SQL Server para reparar uma das instalações do PowerPivot para SharePoint em seu farm. Para obter mais informações sobre soluções em uma instalação do PowerPivot para SharePoint, consulte [implantar soluções do PowerPivot no SharePoint](deploy-power-pivot-solutions-to-sharepoint.md).|  
|PowerPivot: o uso geral da CPU é muito alto.|Sim|No|SharePoint 2010|Esta regra relata o consumo da CPU em nível de sistema. O uso geral da CPU é monitorado porque o Serviço de Sistema do PowerPivot utiliza-o como uma medida de integridade de servidor, para o balanceamento de carga com base em integridade em vários servidores PowerPivot para SharePoint em um farm. Adicione outro servidor de aplicativos ao farm e mova os aplicativos que utilizam intensamente a CPU para esse servidor.|  
|PowerPivot: o Analysis Services não tem recursos suficientes de CPU para executar as operações solicitadas.|Sim|No|SharePoint 2010|A quantidade de recursos de CPU disponíveis para o processo do Analysis Services (msmdsrv.exe) não é suficiente para o nível de atividade neste servidor. Adicione outro servidor PowerPivot para SharePoint para o farm. Para obter mais informações, consulte [lista de verificação de implantação: expansão adicionando servidores PowerPivot a um farm do SharePoint 2010](../../sql-server/install/deployment-checklist-scale-out-adding-powerpivot-servers-sharepoint-2010-farm.md).|  
|PowerPivot: o Analysis Services não tem memória suficiente para executar as operações solicitadas.|No|Não|SharePoint 2010|Esta regra é disparada quando restarem somente 5% de memória para o Analysis Services. Em um servidor de aplicativos do SharePoint, uma instância do SQL Server Analysis Services deve ter sempre uma pequena quantidade de memória reservada que nunca é usada. Como o servidor é associado à memória na maioria de suas operações, o servidor apresenta execução melhor quando não é executado no limite máximo.<br /><br /> Por padrão, os avisos de memória insuficientes ocorrem quando a memória disponível estiver abaixo de 5%. Você pode alterar este valor para ser mais alto ou mais baixo ajustando as configurações na instância do Analysis Services. Para obter mais informações, consulte [regras de integridade do PowerPivot – configurar](configure-power-pivot-health-rules.md).<br /><br /> Os 5% de memória não usados são calculados como um percentual de memória alocada para o Analysis Services. Por exemplo, se você tiver 200 GB de memória total, e for alocado 80% (ou 160 GB) para o Analysis Services, os 5% de memória não usada serão 5% de 160 GB (ou 8 GB).|  
|PowerPivot: o número alto de conexões indica que mais servidores devem ser implantados para tratar a carga atual.|Sim|No|SharePoint 2010|Por padrão, esta regra de integridade é disparada quando o número de conexões distintas de usuários exceder 100. Este valor padrão é arbitrário (não é baseado nas especificações de hardware de seu servidor ou na atividade do usuário), portanto, você pode aumentá-lo ou abaixá-lo dependendo da capacidade do servidor e da atividade do usuário em seu ambiente. Para obter mais informações, consulte [regras de integridade do PowerPivot – configurar](configure-power-pivot-health-rules.md).|  
|PowerPivot: a taxa de eventos de carga para conexões é muito alta.|Sim|No|SharePoint 2013<br /><br /> SharePoint 2010|Por padrão, esta regra de integridade será disparada quando o percentual de eventos de carga para eventos de conexão exceder 50% no período inteiro de coleta de dados (por padrão, 4 horas). Uma taxa alta assim indica um número muito alto de conexões para pastas de trabalho exclusivas ou configurações de redução de cache muito agressivas (onde pastas de trabalho são descarregadas e removidas rapidamente do sistema, enquanto as solicitações para os dados ainda estão ativas). Para evitar contar falsos positivos, deve haver pelo menos 20 conexões por período de 4 horas antes de a taxa ser calculada. Você pode basear esta regra de integridade em uma taxa diferente. Para obter mais informações, consulte [regras de integridade do PowerPivot – configurar](configure-power-pivot-health-rules.md). Para obter mais informações sobre como configurar o cache, consulte [Configurar o uso de espaço em disco &#40;PowerPivot para SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: foram localizados um ou mais arquivos minidump no diretório Logs, indicando uma falha no programa.|No|Não|SharePoint 2013<br /><br /> SharePoint 2010|Os arquivos de minidespejo são gerados durante uma falha de programa para capturar informações sobre o estado do aplicativo de serviço PowerPivot antes da falha. Estas informações podem ser enviadas à Microsoft e usadas para solucionar problemas. Esta regra é disparada quando os arquivos .dmp são detectados no servidor. A regra fornece um link para o arquivo, que pode ser localizado na pasta \OLAP\Log da instância do PowerPivot para SharePoint. Observe que você não pode usar um editor de texto para exibir o conteúdo do arquivo. Exibir um arquivo de minidespejo exige que você baixe e instale uma ferramenta de depuração separada. Para obter mais informações, consulte [Ferramentas de depuração para Windows](/windows-hardware/drivers/debugger/).|  
|PowerPivot: o espaço em disco é insuficiente na unidade onde os dados PowerPivot estão armazenados em cache.|Sim|No|SharePoint 2010|Por padrão, esta regra de integridade é disparada quando o espaço em disco é inferior a 5% na unidade de disco onde a pasta de backup está localizada. Para obter mais informações sobre como definir essa porcentagem, consulte [regras de integridade do PowerPivot – configurar](configure-power-pivot-health-rules.md). Para obter mais informações sobre o uso do disco, consulte [Configurar o uso de espaço em disco &#40;PowerPivot para SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: dados de uso não são atualizados com a frequência esperada.|Sim|No|SharePoint 2013<br /><br /> SharePoint 2010|O PowerPivot para SharePoint usa o sistema interno de coleta de dados de uso para coletar métricas sobre conexões, atualização de dados e tempos de resposta de consultas. Armazena estes dados de uso no banco de dados do aplicativo do serviço PowerPivot, que, por sua vez, atualiza uma pasta de trabalho PowerPivot (PowerPivot Management Data.xlsx) que fornece dados a relatórios no Painel de Gerenciamento do PowerPivot. Esta regra indica que dados de uso não são movidos para o arquivo PowerPivot Management Data.xlsx com frequência suficiente. A regra usa o carimbo de data/hora no arquivo .xlsx como prova de que o arquivo está atualizado. Se houver outros problemas no sistema de coleta de dados de uso que distorcerem a exatidão dos dados, esta regra não detectará. Para solucionar este erro, verifique se os trabalhos de timer estão em execução. Para obter mais informações sobre a coleta de dados de uso, consulte [Configure Usage Data Collection for &#40;PowerPivot para SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|PowerPivot: a conta de processo Midtier deve ter a permissão ' leitura completa ' em todos os SPWebApplications associados.|Não|Sim|SharePoint 2013<br /><br /> SharePoint 2010|A identidade do aplicativo de serviço PowerPivot deve ter permissões de **leitura completa** para acessar os bancos de dados de conteúdo do SharePoint em nome dos usuários que têm permissões somente para exibição em um documento. Para determinar qual conta é usada como a identidade do aplicativo de serviço PowerPivot, abra a página **Configurar contas de serviço** na administração central. Provavelmente, o aplicativo de serviço é executado no pool de aplicativos de serviço **Sistema de Serviços Web do SharePoint** ou em um pool de aplicativos dedicado. Embora essa regra forneça uma opção reparar automaticamente, você obterá resultados melhores se conceder as permissões manualmente fazendo o seguinte:<br /><br /> 1) Em Administração Central, clique em **Gerenciar aplicativos Web**.<br /><br /> 2) Selecione um site e clique em **Política de Usuário**.<br /><br /> 3) Clique em **Adicionar Usuários**.<br /><br /> 4) Selecione (Todas as zonas) e clique em **Avançar**.<br /><br /> 5) em usuários, insira a identidade do aplicativo de serviço PowerPivot e, em seguida, clique na caixa de seleção **leitura completa** . Clique em **Concluir**.<br /><br /> 6) Verifique o reparo. Em Monitoramento, clique em **Revisar definições de regra**. Localize e abra a regra do PowerPivot. Clique em **executar agora**. Volte para **Revisar problemas e soluções** para verificar se a regra não aparece mais.|  
|PowerPivot: o serviço de Logon Secundário (seclogon) é desabilitado|No|Não|SharePoint 2013<br /><br /> SharePoint 2010|O serviço de Logon Secundário é usado para gerar imagens em miniatura de pastas de trabalho PowerPivot na Galeria do PowerPivot. Por padrão, o serviço de Logon Secundário é definido como inicialização manual. Se o serviço for desabilitado, a geração de miniaturas falhará. Além disso, os logs ULS conterão o seguinte erro: "o erro 1058 pode ter como uma causa raiz o fato de o serviço do Windows" logon secundário "estar desabilitado."<br /><br /> Para verificar a configuração de serviço, use o aplicativo de console Serviços para localizar o Logon Secundário e alterar seu **Tipo de Inicialização** para **Manual**. Se você não puder habilitar o serviço, sua organização poderá ter uma política de grupo que desabilita isto. Pergunte a um administrador para determinar se este é o caso.<br /><br /> Depois que você habilitar o serviço, imagens de miniatura ou instantâneo serão atualizadas com o passar do tempo. Como opção, você pode forçar uma atualização reiniciando o serviço e abrindo e em seguida salvando novamente as páginas de propriedades de um relatório específico. Para obter mais informações, consulte [como usar a Galeria PowerPivot](https://go.microsoft.com/fwlink/?LinkId=246462).|  
|PowerPivot: o ADOMD.NET não está instalado em um WFE autônomo que está configurado para administração central|No|Não|SharePoint 2013<br /><br /> SharePoint 2010|O ADOMD.NET é uma biblioteca de cliente do Analysis Services que dá suporte a conexões com um banco de dados do Analysis Services. Em uma implantação do PowerPivot para SharePoint, o ADOMD.NET fornece acesso aos relatórios internos no painel de gerenciamento do PowerPivot na Administração Central. Os relatórios internos são de fato pastas de trabalho PowerPivot que contêm dados inseridos do Analysis Services. O painel de gerenciamento usa o ADOMD.NET para enviar uma solicitação de conexão para o servidor que carrega dados contidos na pasta de trabalho.<br /><br /> Em topologias que incluem a Administração Central que é executada em um servidor Web front-end autônomo, você deve instalar o ADOMD.NET manualmente se quiser exibir estes relatórios no painel de gerenciamento. Para obter mais informações, confira [Instalar o ADOMD.NET em servidores Web front-end executando a Administração Central](../../sql-server/install/install-adomd-net-on-web-front-end-servers-running-central-administration.md).|  
